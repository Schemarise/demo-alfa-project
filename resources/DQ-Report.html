


<!doctype html>
<html lang="en">
<head>
  <title>ALFA Data Quality Report</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-grid.css">
    <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-theme-alpine.css">
    <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.js"></script>

<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-146018870-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->

<div class="container-fluid">
    

    <body>
    <h2>Data Quality Report</h2>
    
    <br/>
    <p>Created: <span class="text-monospace">Tue Jun 21 10:59:33 BST 2025</span></p>
   
    <style>

.node circle {
  fill: #fff;
  stroke: steelblue;
  stroke-width: 3px;
}

.node text {
  font: 13px sans-serif;
}

.link {
  fill: none;
  stroke: #ccc;
  stroke-width: 2px;
}

.nav-tabs .nav-item.show .nav-link, .nav-tabs .nav-link.active {
  font-weight: bold;
  font-size: 1.1em;
}

div.ag-theme-alpine div.ag-row {
    font-size: 13px !important;
}

.cell-error {
  color: red;
}

.cell-pass {
  text-align: left;
}
    </style>

    <h4>Summary:</h4>
    <div id="validationReportsGrid" style="min-height:80px; margin:20px;" class="ag-theme-alpine"></div>

    <h4>Alerts:</h4>
    <div id="validationAlertsGrid" style="width:95vw; margin:20px;" class="ag-theme-alpine"></div>

<script>

const errorNumberRule = {
  "cell-error": params => params.value >= 0,
  "cell-pass": params => params.value == 0
};

const errorTextRule = {
  "cell-error": params => params.value == "Error",
  "cell-pass": params => params.value == "Warning"
};

const commonColProps = {
        wrapText:true,
        sortable:true,
        autoHeight:true,
        resizable:true,
        filter:true,
        maxWidth:800,
        editable:false
    };

var valReportsColumnDefs = [
    { field: "Timestamp", width : "220px"  },
    { field: "SourceSystem", width : "150px"  },
    { field: "SourceSubsystem", width : "180px"  },
    { field: "SourceFeedName", width : "150px"  },
    { field: "DataFormat", width : "150px"  },
    { field: "DataFormatInfo", width : "200px"  },
    { field: "TotalErrors", width : "150px", "cellClassRules": errorNumberRule },
    { field: "TotalWarnings", width : "150px"  },
  ].map(col => ({
  ...commonColProps,
  ...col
}));

const valReportsRowData = [
{"Timestamp":"2025-08-09T13:33","SourceSubsystem":"TradePublisher","SourceFeedName":"CobTradesFeed","SourceSystem":"TradeDataSys","DataFormat":"csv","DataFormatInfo":"cob-trades.csv","TotalErrors":"11","TotalWarnings":"2"}
];  

var valAlertsColumnDefs = [
  { field: "Severity", "cellClassRules": errorTextRule },
  { field: "DataQualityCategory", width : "200px" },
  { field: "ViolatedConstraint", width : "200px" },
  { field: "Message", width : "300px"   },
  { field: "TypeName", width : "200px"   },
  { field: "AssertName", width : "180px"   },
  { field: "FieldName", width : "150px"   },
  { field: "Identification", width : "140px"   },
  { field: "SourceInfo", width : "300px"   },
  { field: "ExceptionDetails", width : "500px"   }
].map(col => ({
  ...commonColProps,
  ...col
}));

const valAlertsRowData = [
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Maturity date '2025-08-01' should be after Trade date '2025-08-08'","TypeName":"ALFABank.TradeDataSys.Trade","AssertName":"ValidMaturityDate","FieldName":"","ViolatedConstraint":"UserDefinedAssert","DataQualityCategory":"Consistency","SourceInfo":"Line:6905", "Identification": "Id: T1234565"},
{"Severity":"Warning","Timestamp":"2025-08-09T13:33","Message":"Found 4 duplicate TradeIds","TypeName":"ALFABank.TradeDataSys.Trade","AssertName":"DuplicateTradeId","FieldName":"","ViolatedConstraint":"UserDefinedAssert","DataQualityCategory":"Uniqueness","SourceInfo":"", "Identification": "Id:T9012234"},
{"Severity":"Warning","Timestamp":"2025-08-09T13:33","Message":"Expected SLA 11:00 breached","TypeName":"ALFABank.TradeDataSys.Trade","AssertName":"BatchRecvTime","FieldName":"","ViolatedConstraint":"UserDefinedAssert","DataQualityCategory":"Timeliness","SourceInfo":"", "Identification": "Id:T9023423"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Mandatory field 'PartyId' not specified","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"PartyId","ViolatedConstraint":"MandatoryFieldNotSet","DataQualityCategory":"Completeness","SourceInfo":"Line:2309", "Identification": "Id:T9015674"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Mandatory field 'PartyId' not specified","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"PartyId","ViolatedConstraint":"MandatoryFieldNotSet","DataQualityCategory":"Completeness","SourceInfo":"Line:2311", "Identification": "Id:T9012324"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys. Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5350", "Identification": "Id:T9012343"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5351", "Identification": "Id:T9023446"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5352", "Identification": "Id:T9012956"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5353", "Identification": "Id:T9014564"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5354", "Identification": "Id:T9031249"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5355", "Identification": "Id:T9034455"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5356", "Identification": "Id: T1234566"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5357", "Identification": "Id: T1234567"},
{"Severity":"Error","Timestamp":"2025-08-09T13:33","Message":"Unknown field 'ContryCode'","TypeName":"ALFABank.TradeDataSys.Trade","FieldName":"ContryCode","ViolatedConstraint":"UnknownField","DataQualityCategory":"Conformity","SourceInfo":"Line:5358","Identification": "Id: T1234568"}
];

buildValidationReportGrid();

buildValidationAlertsGrid();

function CheckboxRenderer() {}

CheckboxRenderer.prototype.init = function(params) {
  this.params = params;

  this.eGui = document.createElement('input');
  this.eGui.type = 'checkbox';
  this.eGui.checked = params.value;

  this.checkedHandler = this.checkedHandler.bind(this);
  this.eGui.addEventListener('click', this.checkedHandler);
}

CheckboxRenderer.prototype.checkedHandler = function(e) {
  let checked = e.target.checked;
  let colId = this.params.column.colId;
  this.params.node.setDataValue(colId, checked);
}

CheckboxRenderer.prototype.getGui = function(params) {
  return this.eGui;
}

CheckboxRenderer.prototype.destroy = function(params) {
  this.eGui.removeEventListener('click', this.checkedHandler);
}


function buildValidationReportGrid() {
    buildGrid('#validationReportsGrid', valReportsColumnDefs, valReportsRowData);
}

function buildValidationAlertsGrid() {
    buildGrid('#validationAlertsGrid', valAlertsColumnDefs, valAlertsRowData);
}

function buildGrid(divname, coldefs, rowdata) {
      const gridOptions = {
      columnDefs: coldefs,
      rowData: rowdata,
      enableCellTextSelection: true,
      groupDisplayType: 'groupRows',
      groupDefaultExpanded: 1,
      domLayout:'autoHeight',
      autoSizeStrategy: {
          type: "fitCellContents"
      }
    };

    gridOptions.components = {
      checkboxRenderer: CheckboxRenderer
    }

    // setup the grid after the page has finished loading
    document.addEventListener('DOMContentLoaded', () => {
        const gridDiv = document.querySelector(divname);
        agGrid.createGrid(gridDiv, gridOptions);
    });
}


      </script>

    </body>
  </div>
</html>
